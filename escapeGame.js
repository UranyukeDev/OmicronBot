const Discord = require("discord.js");

const WIDTH = 13;
const HEIGHT = 13;

class EscapeGame
{
	constructor()
	{
		this.advice = "";
		this.userID;
		this.gameMap = [];
		this.gameEmbed = null;
		this.inGame = false;
		this.level = 1;
		this.key;
	}

	generateLevel()
	{
		this.advice = "*no info*";
		this.key = false;
		switch(this.level) //ğŸŸ«, âš«, ğŸ‘¤, ğŸ‘», ğŸšª, ğŸ”¥, ğŸ“¦, ğŸ”‘, ğŸ”’
		{
			case 1:
				this.advice = "ğŸ‘» -> Ghosts move in random direction you have to avoid touching them.";
				this.gameMap = [
				['ğŸŸ«','ğŸŸ«','ğŸŸ«','ğŸŸ«','ğŸŸ«','ğŸŸ«','ğŸŸ«','ğŸŸ«','ğŸŸ«','ğŸŸ«','ğŸŸ«','ğŸŸ«','ğŸŸ«',],
				['ğŸŸ«','âš«','âš«','âš«','âš«','âš«','âš«','âš«','âš«','âš«','âš«','âš«','ğŸŸ«',],
				['ğŸŸ«','âš«','âš«','âš«','âš«','âš«','âš«','âš«','âš«','âš«','âš«','âš«','ğŸŸ«',],
				['ğŸŸ«','âš«','âš«','âš«','âš«','âš«','âš«','âš«','âš«','âš«','âš«','âš«','ğŸŸ«',],
				['ğŸŸ«','âš«','âš«','âš«','ğŸŸ«','ğŸŸ«','ğŸŸ«','ğŸŸ«','ğŸŸ«','âš«','âš«','âš«','ğŸŸ«',],
				['ğŸŸ«','âš«','âš«','âš«','ğŸŸ«','âš«','âš«','âš«','ğŸŸ«','âš«','âš«','âš«','ğŸŸ«',],
				['ğŸŸ«','âš«','ğŸ‘»','âš«','ğŸŸ«','âš«','ğŸ‘¤','âš«','ğŸŸ«','âš«','ğŸ‘»','âš«','ğŸŸ«',],
				['ğŸŸ«','âš«','âš«','âš«','ğŸŸ«','âš«','âš«','âš«','ğŸŸ«','âš«','âš«','âš«','ğŸŸ«',],
				['ğŸŸ«','âš«','âš«','âš«','ğŸŸ«','âš«','âš«','âš«','ğŸŸ«','âš«','âš«','âš«','ğŸŸ«',],
				['ğŸŸ«','âš«','âš«','âš«','âš«','âš«','âš«','âš«','ğŸŸ«','âš«','âš«','âš«','ğŸŸ«',],
				['ğŸŸ«','âš«','âš«','âš«','âš«','âš«','âš«','âš«','ğŸŸ«','âš«','ğŸšª','âš«','ğŸŸ«',],
				['ğŸŸ«','âš«','âš«','âš«','âš«','âš«','âš«','âš«','ğŸŸ«','âš«','âš«','âš«','ğŸŸ«',],
				['ğŸŸ«','ğŸŸ«','ğŸŸ«','ğŸŸ«','ğŸŸ«','ğŸŸ«','ğŸŸ«','ğŸŸ«','ğŸŸ«','ğŸŸ«','ğŸŸ«','ğŸŸ«','ğŸŸ«',]
				]; break;
			case 2:
				this.advice = "ğŸ”¥ -> Fire works like walls but when you enter it you will die unlike the wall which pushes you back.";
				this.gameMap = [
				['ğŸŸ«','ğŸŸ«','ğŸŸ«','ğŸŸ«','ğŸŸ«','ğŸŸ«','ğŸŸ«','ğŸŸ«','ğŸŸ«','ğŸŸ«','ğŸŸ«','ğŸŸ«','ğŸŸ«',],
				['ğŸŸ«','âš«','âš«','âš«','âš«','âš«','âš«','âš«','ğŸ”¥','âš«','âš«','âš«','ğŸŸ«',],
				['ğŸŸ«','âš«','ğŸ‘¤','âš«','âš«','âš«','ğŸ”¥','âš«','âš«','âš«','ğŸ‘»','âš«','ğŸŸ«',],
				['ğŸŸ«','âš«','âš«','âš«','ğŸ”¥','âš«','âš«','âš«','âš«','âš«','âš«','âš«','ğŸŸ«',],
				['ğŸŸ«','ğŸŸ«','ğŸŸ«','ğŸŸ«','ğŸŸ«','ğŸŸ«','ğŸŸ«','ğŸŸ«','ğŸŸ«','âš«','âš«','âš«','ğŸŸ«',],
				['ğŸŸ«','âš«','âš«','âš«','âš«','âš«','âš«','âš«','âš«','âš«','âš«','âš«','ğŸŸ«',],
				['ğŸŸ«','âš«','ğŸ”¥','âš«','âš«','âš«','ğŸ‘»','âš«','âš«','âš«','ğŸ”¥','âš«','ğŸŸ«',],
				['ğŸŸ«','âš«','âš«','âš«','âš«','âš«','âš«','âš«','âš«','âš«','âš«','âš«','ğŸŸ«',],
				['ğŸŸ«','âš«','âš«','âš«','ğŸŸ«','ğŸŸ«','ğŸŸ«','ğŸŸ«','ğŸŸ«','ğŸŸ«','ğŸŸ«','ğŸŸ«','ğŸŸ«',],
				['ğŸŸ«','âš«','âš«','âš«','âš«','âš«','âš«','âš«','ğŸ”¥','âš«','âš«','âš«','ğŸŸ«',],
				['ğŸŸ«','âš«','ğŸ‘»','âš«','âš«','âš«','ğŸ”¥','âš«','âš«','âš«','ğŸšª','âš«','ğŸŸ«',],
				['ğŸŸ«','âš«','âš«','âš«','ğŸ”¥','âš«','âš«','âš«','âš«','âš«','âš«','âš«','ğŸŸ«',],
				['ğŸŸ«','ğŸŸ«','ğŸŸ«','ğŸŸ«','ğŸŸ«','ğŸŸ«','ğŸŸ«','ğŸŸ«','ğŸŸ«','ğŸŸ«','ğŸŸ«','ğŸŸ«','ğŸŸ«',]
				]; break;
			case 3:
				this.gameMap = [
				['ğŸŸ«','ğŸŸ«','ğŸŸ«','ğŸŸ«','ğŸŸ«','ğŸŸ«','ğŸŸ«','ğŸŸ«','ğŸŸ«','ğŸŸ«','ğŸŸ«','ğŸŸ«','ğŸŸ«',],
				['ğŸŸ«','âš«','âš«','ğŸ”¥','âš«','âš«','âš«','âš«','âš«','ğŸ”¥','âš«','âš«','ğŸŸ«',],
				['ğŸŸ«','âš«','âš«','ğŸ”¥','âš«','âš«','ğŸ”¥','ğŸ‘»','âš«','ğŸ”¥','âš«','âš«','ğŸŸ«',],
				['ğŸŸ«','âš«','âš«','ğŸ”¥','âš«','âš«','âš«','âš«','âš«','ğŸ”¥','âš«','âš«','ğŸŸ«',],
				['ğŸŸ«','ğŸŸ«','ğŸŸ«','ğŸŸ«','âš«','ğŸŸ«','ğŸŸ«','ğŸŸ«','âš«','ğŸŸ«','ğŸŸ«','ğŸŸ«','ğŸŸ«',],
				['ğŸŸ«','âš«','âš«','âš«','âš«','âš«','âš«','ğŸ”¥','âš«','âš«','âš«','âš«','ğŸŸ«',],
				['ğŸŸ«','âš«','ğŸ‘¤','âš«','âš«','âš«','âš«','ğŸ”¥','âš«','ğŸ‘»','ğŸšª','âš«','ğŸŸ«',],
				['ğŸŸ«','âš«','âš«','âš«','âš«','âš«','âš«','ğŸ”¥','âš«','âš«','âš«','âš«','ğŸŸ«',],
				['ğŸŸ«','ğŸŸ«','ğŸŸ«','ğŸŸ«','âš«','ğŸŸ«','ğŸŸ«','ğŸŸ«','âš«','ğŸŸ«','ğŸŸ«','ğŸŸ«','ğŸŸ«',],
				['ğŸŸ«','âš«','âš«','ğŸ”¥','âš«','âš«','âš«','âš«','âš«','ğŸ”¥','âš«','âš«','ğŸŸ«',],
				['ğŸŸ«','âš«','âš«','ğŸ”¥','âš«','ğŸ‘»','ğŸ”¥','âš«','âš«','ğŸ”¥','âš«','âš«','ğŸŸ«',],
				['ğŸŸ«','âš«','âš«','ğŸ”¥','âš«','âš«','âš«','âš«','âš«','ğŸ”¥','âš«','âš«','ğŸŸ«',],
				['ğŸŸ«','ğŸŸ«','ğŸŸ«','ğŸŸ«','ğŸŸ«','ğŸŸ«','ğŸŸ«','ğŸŸ«','ğŸŸ«','ğŸŸ«','ğŸŸ«','ğŸŸ«','ğŸŸ«',]
				]; break;
			case 4:
				this.advice = "ğŸ“¦ -> Boxes can be pushed by the player.";
				this.gameMap = [
				['ğŸŸ«','ğŸŸ«','ğŸŸ«','ğŸŸ«','ğŸŸ«','ğŸŸ«','ğŸŸ«','ğŸŸ«','ğŸŸ«','ğŸŸ«','ğŸŸ«','ğŸŸ«','ğŸŸ«',],
				['ğŸŸ«','âš«','âš«','âš«','ğŸŸ«','âš«','ğŸ“¦','âš«','âš«','âš«','âš«','âš«','ğŸŸ«',],
				['ğŸŸ«','ğŸ”¥','ğŸ‘¤','ğŸ”¥','ğŸŸ«','âš«','âš«','ğŸ“¦','âš«','âš«','âš«','âš«','ğŸŸ«',],
				['ğŸŸ«','âš«','âš«','âš«','ğŸŸ«','âš«','ğŸŸ«','ğŸŸ«','ğŸŸ«','âš«','âš«','âš«','ğŸŸ«',],
				['ğŸŸ«','ğŸ”¥','âš«','ğŸ”¥','ğŸŸ«','âš«','ğŸŸ«','ğŸšª','ğŸŸ«','ğŸ”¥','âš«','ğŸ”¥','ğŸŸ«',],
				['ğŸŸ«','âš«','âš«','âš«','ğŸŸ«','âš«','ğŸŸ«','âš«','ğŸŸ«','âš«','âš«','âš«','ğŸŸ«',],
				['ğŸŸ«','ğŸ”¥','âš«','ğŸ”¥','ğŸŸ«','âš«','ğŸŸ«','âš«','ğŸŸ«','ğŸ”¥','âš«','ğŸ”¥','ğŸŸ«',],
				['ğŸŸ«','âš«','âš«','âš«','ğŸŸ«','âš«','âš«','âš«','ğŸŸ«','âš«','âš«','âš«','ğŸŸ«',],
				['ğŸŸ«','ğŸ”¥','âš«','ğŸ”¥','ğŸŸ«','âš«','âš«','âš«','ğŸŸ«','ğŸ”¥','âš«','ğŸ”¥','ğŸŸ«',],
				['ğŸŸ«','âš«','âš«','âš«','ğŸŸ«','ğŸŸ«','ğŸŸ«','ğŸŸ«','ğŸŸ«','âš«','âš«','âš«','ğŸŸ«',],
				['ğŸŸ«','âš«','âš«','ğŸ“¦','âš«','âš«','ğŸ“¦','âš«','ğŸ“¦','âš«','âš«','âš«','ğŸŸ«',],
				['ğŸŸ«','âš«','âš«','ğŸ“¦','âš«','ğŸ“¦','âš«','âš«','ğŸ“¦','âš«','âš«','âš«','ğŸŸ«',],
				['ğŸŸ«','ğŸŸ«','ğŸŸ«','ğŸŸ«','ğŸŸ«','ğŸŸ«','ğŸŸ«','ğŸŸ«','ğŸŸ«','ğŸŸ«','ğŸŸ«','ğŸŸ«','ğŸŸ«',]
				]; break;
			case 5:
				this.gameMap = [
				['ğŸŸ«','ğŸŸ«','ğŸŸ«','ğŸŸ«','ğŸŸ«','ğŸŸ«','ğŸŸ«','ğŸŸ«','ğŸŸ«','ğŸŸ«','ğŸŸ«','ğŸŸ«','ğŸŸ«',],
				['ğŸŸ«','âš«','âš«','âš«','ğŸ“¦','âš«','ğŸ“¦','âš«','ğŸ“¦','ğŸ“¦','âš«','âš«','ğŸŸ«',],
				['ğŸŸ«','âš«','âš«','âš«','âš«','ğŸ“¦','âš«','ğŸ“¦','âš«','ğŸ“¦','ğŸ“¦','âš«','ğŸŸ«',],
				['ğŸŸ«','âš«','âš«','âš«','âš«','âš«','ğŸ“¦','âš«','ğŸ“¦','âš«','âš«','âš«','ğŸŸ«',],
				['ğŸŸ«','âš«','âš«','âš«','ğŸŸ«','ğŸŸ«','ğŸŸ«','ğŸŸ«','ğŸŸ«','âš«','ğŸ‘»','âš«','ğŸŸ«',],
				['ğŸŸ«','âš«','ğŸ“¦','âš«','ğŸŸ«','âš«','âš«','âš«','ğŸŸ«','âš«','âš«','âš«','ğŸŸ«',],
				['ğŸŸ«','ğŸ“¦','ğŸ“¦','ğŸ“¦','ğŸŸ«','âš«','ğŸ”¥','âš«','ğŸŸ«','âš«','âš«','ğŸ“¦','ğŸŸ«',],
				['ğŸŸ«','âš«','âš«','âš«','ğŸŸ«','âš«','ğŸ”¥','âš«','ğŸŸ«','ğŸ“¦','ğŸ“¦','ğŸ“¦','ğŸŸ«',],
				['ğŸŸ«','âš«','ğŸ‘»','âš«','ğŸŸ«','âš«','ğŸ”¥','âš«','ğŸŸ«','âš«','âš«','âš«','ğŸŸ«',],
				['ğŸŸ«','âš«','âš«','âš«','ğŸŸ«','âš«','ğŸ”¥','âš«','ğŸŸ«','ğŸ”¥','âš«','âš«','ğŸŸ«',],
				['ğŸŸ«','âš«','ğŸ‘¤','âš«','ğŸŸ«','âš«','ğŸ”¥','âš«','ğŸŸ«','âš«','ğŸšª','âš«','ğŸŸ«',],
				['ğŸŸ«','âš«','âš«','âš«','ğŸŸ«','âš«','âš«','âš«','ğŸŸ«','âš«','âš«','âš«','ğŸŸ«',],
				['ğŸŸ«','ğŸŸ«','ğŸŸ«','ğŸŸ«','ğŸŸ«','ğŸŸ«','ğŸŸ«','ğŸŸ«','ğŸŸ«','ğŸŸ«','ğŸŸ«','ğŸŸ«','ğŸŸ«',]
				]; break;
			case 6:
				this.advice = "ğŸ”‘ -> The key allows the player to unlock a door.";
				this.gameMap = [
				['ğŸŸ«','ğŸŸ«','ğŸŸ«','ğŸŸ«','ğŸŸ«','ğŸŸ«','ğŸŸ«','ğŸŸ«','ğŸŸ«','ğŸŸ«','ğŸŸ«','ğŸŸ«','ğŸŸ«',],
				['ğŸŸ«','âš«','âš«','ğŸŸ«','âš«','ğŸŸ«','âš«','âš«','ğŸŸ«','âš«','âš«','âš«','ğŸŸ«',],
				['ğŸŸ«','âš«','âš«','ğŸŸ«','âš«','ğŸŸ«','âš«','âš«','ğŸŸ«','âš«','ğŸšª','âš«','ğŸŸ«',],
				['ğŸŸ«','âš«','âš«','âš«','âš«','ğŸ”’','âš«','âš«','ğŸŸ«','âš«','âš«','âš«','ğŸŸ«',],
				['ğŸŸ«','ğŸ‘»','âš«','ğŸŸ«','âš«','ğŸŸ«','âš«','ğŸ‘»','ğŸŸ«','âš«','ğŸŸ«','ğŸŸ«','ğŸŸ«',],
				['ğŸŸ«','âš«','âš«','ğŸŸ«','âš«','ğŸŸ«','âš«','âš«','ğŸŸ«','ğŸ“¦','ğŸŸ«','âš«','ğŸŸ«',],
				['ğŸŸ«','âš«','âš«','ğŸŸ«','âš«','ğŸŸ«','âš«','âš«','âš«','ğŸ“¦','âš«','âš«','ğŸŸ«',],
				['ğŸŸ«','ğŸ”‘','âš«','ğŸŸ«','âš«','ğŸŸ«','âš«','âš«','ğŸŸ«','âš«','ğŸŸ«','âš«','ğŸŸ«',],
				['ğŸŸ«','ğŸŸ«','ğŸŸ«','ğŸŸ«','âš«','ğŸŸ«','ğŸŸ«','ğŸŸ«','ğŸŸ«','âš«','ğŸŸ«','ğŸŸ«','ğŸŸ«',],
				['ğŸŸ«','âš«','âš«','âš«','âš«','âš«','âš«','âš«','âš«','âš«','âš«','âš«','ğŸŸ«',],
				['ğŸŸ«','âš«','âš«','âš«','ğŸ”¥','ğŸ‘»','âš«','âš«','ğŸ‘»','âš«','ğŸ‘¤','âš«','ğŸŸ«',],
				['ğŸŸ«','âš«','âš«','âš«','âš«','âš«','âš«','âš«','âš«','âš«','âš«','âš«','ğŸŸ«',],
				['ğŸŸ«','ğŸŸ«','ğŸŸ«','ğŸŸ«','ğŸŸ«','ğŸŸ«','ğŸŸ«','ğŸŸ«','ğŸŸ«','ğŸŸ«','ğŸŸ«','ğŸŸ«','ğŸŸ«',]
				]; break;
			case 7:
				this.gameMap = [
				['ğŸŸ«','ğŸŸ«','ğŸŸ«','ğŸŸ«','ğŸŸ«','ğŸŸ«','ğŸŸ«','ğŸŸ«','ğŸŸ«','ğŸŸ«','ğŸŸ«','ğŸŸ«','ğŸŸ«',],
				['ğŸŸ«','ğŸ‘¤','ğŸ”¥','âš«','âš«','âš«','ğŸ”¥','âš«','âš«','âš«','ğŸ”¥','âš«','ğŸŸ«',],
				['ğŸŸ«','âš«','âš«','âš«','ğŸ”¥','âš«','âš«','âš«','ğŸ”¥','âš«','âš«','âš«','ğŸŸ«',],
				['ğŸŸ«','âš«','ğŸ”¥','âš«','âš«','ğŸ‘»','ğŸ”¥','âš«','âš«','ğŸ‘»','ğŸ”¥','âš«','ğŸŸ«',],
				['ğŸŸ«','âš«','âš«','âš«','ğŸ”¥','âš«','âš«','âš«','ğŸ”¥','âš«','âš«','âš«','ğŸŸ«',],
				['ğŸŸ«','âš«','ğŸ”¥','âš«','âš«','âš«','ğŸ”¥','âš«','âš«','âš«','ğŸ”¥','âš«','ğŸŸ«',],
				['ğŸŸ«','âš«','âš«','ğŸ‘»','ğŸ”¥','âš«','âš«','ğŸ‘»','ğŸ”¥','âš«','âš«','âš«','ğŸŸ«',],
				['ğŸŸ«','âš«','ğŸ”¥','âš«','âš«','âš«','ğŸ”¥','âš«','âš«','âš«','ğŸ”¥','âš«','ğŸŸ«',],
				['ğŸŸ«','âš«','âš«','âš«','ğŸ”¥','âš«','âš«','âš«','ğŸ”¥','âš«','âš«','âš«','ğŸŸ«',],
				['ğŸŸ«','âš«','ğŸ”¥','âš«','âš«','ğŸ‘»','ğŸ”¥','âš«','âš«','ğŸ‘»','ğŸ”¥','âš«','ğŸŸ«',],
				['ğŸŸ«','âš«','âš«','âš«','ğŸ”¥','âš«','âš«','âš«','ğŸ”¥','âš«','âš«','âš«','ğŸŸ«',],
				['ğŸŸ«','âš«','ğŸ”¥','âš«','âš«','âš«','ğŸ”¥','âš«','âš«','âš«','ğŸ”¥','ğŸšª','ğŸŸ«',],
				['ğŸŸ«','ğŸŸ«','ğŸŸ«','ğŸŸ«','ğŸŸ«','ğŸŸ«','ğŸŸ«','ğŸŸ«','ğŸŸ«','ğŸŸ«','ğŸŸ«','ğŸŸ«','ğŸŸ«',]
				]; break;
			case 8:
				this.advice = "ğŸ§  -> Here you are going to need to use your brain.";
				this.gameMap = [
				['ğŸŸ«','ğŸŸ«','ğŸŸ«','ğŸŸ«','ğŸŸ«','ğŸŸ«','ğŸŸ«','ğŸŸ«','ğŸŸ«','ğŸŸ«','ğŸŸ«','ğŸŸ«','ğŸŸ«',],
				['ğŸŸ«','âš«','âš«','ğŸŸ«','ğŸŸ«','âš«','ğŸ‘¤','âš«','ğŸŸ«','âš«','âš«','âš«','ğŸŸ«',],
				['ğŸŸ«','âš«','ğŸ”¥','ğŸŸ«','ğŸŸ«','âš«','âš«','âš«','ğŸŸ«','âš«','âš«','âš«','ğŸŸ«',],
				['ğŸŸ«','âš«','âš«','ğŸŸ«','ğŸŸ«','ğŸ“¦','ğŸ“¦','ğŸ“¦','ğŸŸ«','âš«','âš«','âš«','ğŸŸ«',],
				['ğŸŸ«','âš«','âš«','âš«','âš«','âš«','âš«','âš«','ğŸŸ«','ğŸŸ«','âš«','âš«','ğŸŸ«',],
				['ğŸŸ«','âš«','âš«','ğŸŸ«','ğŸŸ«','âš«','ğŸ“¦','âš«','âš«','ğŸŸ«','ğŸŸ«','ğŸŸ«','ğŸŸ«',],
				['ğŸŸ«','âš«','ğŸ”¥','ğŸŸ«','ğŸŸ«','âš«','ğŸŸ«','ğŸ“¦','ğŸ“¦','âš«','âš«','ğŸŸ«','ğŸŸ«',],
				['ğŸŸ«','âš«','âš«','ğŸŸ«','ğŸŸ«','âš«','âš«','ğŸ“¦','âš«','âš«','ğŸŸ«','ğŸŸ«','ğŸŸ«',],
				['ğŸŸ«','ğŸ”¥','âš«','ğŸŸ«','ğŸŸ«','ğŸŸ«','ğŸŸ«','ğŸŸ«','ğŸ”’','ğŸ“¦','ğŸŸ«','ğŸŸ«','ğŸŸ«',],
				['ğŸŸ«','âš«','âš«','âš«','ğŸ”¥','âš«','âš«','ğŸŸ«','âš«','ğŸŸ«','âš«','ğŸŸ«','ğŸŸ«',],
				['ğŸŸ«','âš«','ğŸ”¥','ğŸ‘»','âš«','âš«','ğŸ”‘','ğŸŸ«','âš«','ğŸšª','âš«','ğŸŸ«','ğŸŸ«',],
				['ğŸŸ«','âš«','âš«','âš«','âš«','ğŸ”¥','âš«','ğŸŸ«','âš«','âš«','âš«','ğŸŸ«','ğŸŸ«',],
				['ğŸŸ«','ğŸŸ«','ğŸŸ«','ğŸŸ«','ğŸŸ«','ğŸŸ«','ğŸŸ«','ğŸŸ«','ğŸŸ«','ğŸŸ«','ğŸŸ«','ğŸŸ«','ğŸŸ«',]
				]; break;
			case 9:
				this.gameMap = [
				['ğŸŸ«','ğŸŸ«','ğŸŸ«','ğŸŸ«','ğŸŸ«','ğŸŸ«','ğŸŸ«','ğŸŸ«','ğŸŸ«','ğŸŸ«','ğŸŸ«','ğŸŸ«','ğŸŸ«',],
				['ğŸŸ«','âš«','âš«','âš«','âš«','ğŸ“¦','âš«','ğŸ“¦','âš«','âš«','âš«','âš«','ğŸŸ«',],
				['ğŸŸ«','âš«','âš«','ğŸŸ«','ğŸŸ«','ğŸŸ«','âš«','ğŸŸ«','ğŸŸ«','ğŸŸ«','âš«','âš«','ğŸŸ«',],
				['ğŸŸ«','ğŸ“¦','ğŸŸ«','âš«','ğŸŸ«','âš«','ğŸ‘»','âš«','ğŸŸ«','ğŸ”‘','ğŸŸ«','ğŸ“¦','ğŸŸ«',],
				['ğŸŸ«','âš«','ğŸŸ«','âš«','ğŸŸ«','âš«','âš«','âš«','ğŸŸ«','âš«','ğŸŸ«','âš«','ğŸŸ«',],
				['ğŸŸ«','âš«','ğŸŸ«','âš«','ğŸŸ«','ğŸ“¦','ğŸ”’','ğŸ“¦','ğŸŸ«','âš«','ğŸŸ«','âš«','ğŸŸ«',],
				['ğŸŸ«','âš«','ğŸŸ«','ğŸ“¦','ğŸ”¥','ğŸ“¦','âš«','âš«','ğŸ”¥','âš«','ğŸŸ«','âš«','ğŸŸ«',],
				['ğŸŸ«','âš«','ğŸŸ«','âš«','âš«','ğŸ“¦','ğŸ“¦','ğŸ“¦','âš«','âš«','ğŸŸ«','âš«','ğŸŸ«',],
				['ğŸŸ«','âš«','ğŸŸ«','ğŸ“¦','ğŸ“¦','ğŸ“¦','âš«','âš«','ğŸ“¦','ğŸ“¦','ğŸŸ«','âš«','ğŸŸ«',],
				['ğŸŸ«','âš«','ğŸŸ«','ğŸ‘¤','âš«','ğŸ“¦','âš«','âš«','ğŸ“¦','âš«','ğŸŸ«','âš«','ğŸŸ«',],
				['ğŸŸ«','âš«','âš«','ğŸŸ«','ğŸŸ«','ğŸŸ«','ğŸŸ«','ğŸŸ«','ğŸŸ«','ğŸŸ«','âš«','âš«','ğŸŸ«',],
				['ğŸŸ«','âš«','âš«','âš«','âš«','âš«','ğŸšª','âš«','âš«','âš«','âš«','âš«','ğŸŸ«',],
				['ğŸŸ«','ğŸŸ«','ğŸŸ«','ğŸŸ«','ğŸŸ«','ğŸŸ«','ğŸŸ«','ğŸŸ«','ğŸŸ«','ğŸŸ«','ğŸŸ«','ğŸŸ«','ğŸŸ«',]
				]; break;
			case 10:
				this.gameMap = [
				['ğŸŸ«','ğŸŸ«','ğŸŸ«','ğŸŸ«','ğŸŸ«','ğŸŸ«','ğŸŸ«','ğŸŸ«','ğŸŸ«','ğŸŸ«','ğŸŸ«','ğŸŸ«','ğŸŸ«',],
				['ğŸŸ«','âš«','âš«','âš«','âš«','âš«','âš«','âš«','âš«','âš«','âš«','âš«','ğŸŸ«',],
				['ğŸŸ«','âš«','âš«','âš«','âš«','âš«','âš«','âš«','âš«','âš«','âš«','âš«','ğŸŸ«',],
				['ğŸŸ«','âš«','âš«','âš«','âš«','âš«','âš«','âš«','âš«','âš«','âš«','âš«','ğŸŸ«',],
				['ğŸŸ«','âš«','âš«','âš«','âš«','âš«','âš«','âš«','âš«','âš«','âš«','âš«','ğŸŸ«',],
				['ğŸŸ«','âš«','âš«','âš«','âš«','âš«','âš«','âš«','âš«','âš«','âš«','âš«','ğŸŸ«',],
				['ğŸŸ«','âš«','âš«','âš«','âš«','âš«','ğŸ‘¤','âš«','âš«','âš«','âš«','âš«','ğŸŸ«',],
				['ğŸŸ«','âš«','âš«','âš«','âš«','âš«','âš«','âš«','âš«','âš«','âš«','âš«','ğŸŸ«',],
				['ğŸŸ«','âš«','âš«','âš«','âš«','âš«','âš«','âš«','âš«','âš«','âš«','âš«','ğŸŸ«',],
				['ğŸŸ«','âš«','âš«','âš«','âš«','âš«','âš«','âš«','âš«','âš«','âš«','âš«','ğŸŸ«',],
				['ğŸŸ«','âš«','âš«','âš«','âš«','âš«','âš«','âš«','âš«','âš«','âš«','âš«','ğŸŸ«',],
				['ğŸŸ«','âš«','âš«','âš«','âš«','âš«','âš«','âš«','âš«','âš«','âš«','âš«','ğŸŸ«',],
				['ğŸŸ«','ğŸŸ«','ğŸŸ«','ğŸŸ«','ğŸŸ«','ğŸŸ«','ğŸŸ«','ğŸŸ«','ğŸŸ«','ğŸŸ«','ğŸŸ«','ğŸŸ«','ğŸŸ«',]
				]; break;
		}
	}

	convertToString()
	{
		let str = "";
		for(var i = 0; i < WIDTH; i++)
		{
			for(var j = 0; j < HEIGHT; j++)
			{
				str += this.gameMap[i][j];
			}
			str += "\n";
		}

		return str;
	}

	newGame(message)
	{	
		if (this.inGame)
    	{
        	message.channel.send(":confused: oops, looks like someone is already playing escape game. Why don't you try another game in the meantime?");
        	return;
    	}

    	this.userID = message.author.id;
    	this.inGame = true;
    	this.level = 1;
    	this.advice = "";
    	this.key = false;

    	this.generateLevel();

    	const embed = new Discord.MessageEmbed()
        	.setColor("#000066")
        	.setTitle("Escape Game")
        	.setDescription("**Level :** " + this.level + "\n\n" + this.advice + "\n\n" + this.convertToString())
        	.setTimestamp();

        message.channel.send(embed).then(emsg =>
    	{
        	this.gameEmbed = emsg;
        	this.gameEmbed.react('â¬†');
        	this.gameEmbed.react('â¬…ï¸');
        	this.gameEmbed.react('â¡ï¸');
        	this.gameEmbed.react('â¬‡');
        	this.gameEmbed.react('ğŸ”„');

        	this.waitForReaction();
    	});
	}

	moveGhosts()
	{
		let gx = [];
		let gy = [];
		for(var i = 0; i < WIDTH; i++)
		{
			for(var j = 0; j < HEIGHT; j++)
			{
				if(this.gameMap[i][j] == 'ğŸ‘»')
				{
					let rnd = Math.floor(Math.random() * 4);
					switch(rnd)
					{
						case 0: //left
							if(this.gameMap[i][j-1] == 'âš«')
							{
								this.gameMap[i][j] = 'âš«';
								gx.push(j-1);
								gy.push(i);
							} break;
						case 1: //right
							if(this.gameMap[i][j+1] == 'âš«')
							{
								this.gameMap[i][j] = 'âš«';
								gx.push(j+1);
								gy.push(i);
							} break;
						case 2: //up
							if(this.gameMap[i-1][j] == 'âš«')
							{
								this.gameMap[i][j] = 'âš«';
								gx.push(j);
								gy.push(i-1);
							} break;
						case 3: //down
							if(this.gameMap[i+1][j] == 'âš«')
							{
								this.gameMap[i][j] = 'âš«';
								gx.push(j);
								gy.push(i+1);
							} break;
					}
				} else if(this.gameMap[i][j] == 'ğŸ”’')
				{
					if(this.key == true)
					{
						this.gameMap[i][j] = 'âš«';
					}
				}
			}
		}

		for(var i = 0; i < gx.length; i++)
		{
			this.gameMap[gy[i]][gx[i]] = 'ğŸ‘»';
		}
	}

	step()
	{
		const editEmbed = new Discord.MessageEmbed()
	        .setColor("#000066")
	        .setTitle("Escape Game")
	        .setDescription("**Level :** " + this.level + "\n\n" + this.advice + "\n\n" + this.convertToString())
	        .setTimestamp();
	    this.gameEmbed.edit(editEmbed);

	    this.waitForReaction();
	}

	gameOver()
	{
		this.inGame = false;
    	const editEmbed = new Discord.MessageEmbed()
        	.setColor("#000066")
        	.setTitle("Escape Game")
        	.setDescription("GAME OVER!\nLEVELS COMPLETED: " + this.level)
        	.setTimestamp();
    	this.gameEmbed.edit(editEmbed);
    	this.gameEmbed.reactions.removeAll();
	}

	filter(reaction, user)
	{
		return ['â¬†', 'â¬…ï¸', 'â¡ï¸', 'â¬‡', 'ğŸ”„'].includes(reaction.emoji.name) && user.id !== this.gameEmbed.author.id;
	}

	waitForReaction()
	{
		let x, y;
		for(var i = 0; i < WIDTH; i++)
		{
			for(var j = 0; j < HEIGHT; j++)
			{
				if(this.gameMap[i][j] == 'ğŸ‘¤')
				{
					y = i;
					x = j;
				}
			}
		}
		this.moveGhosts();
		this.gameEmbed.awaitReactions((reaction, user) => this.filter(reaction, user), { max: 1, time: 60000, errors: ["time"] })
	        .then(collected => 
	        {
	            const reaction = collected.first();
	            let dead = false;

	            if (reaction.emoji.name === 'â¬…ï¸') //LEFT
	            {
	                if(this.gameMap[y][x-1] == 'âš«')
	                {
	                	this.gameMap[y][x] = 'âš«';
	                	this.gameMap[y][x-1] = 'ğŸ‘¤';
	                } else if(this.gameMap[y][x-1] == 'ğŸŸ«')
	                {
	                	this.gameMap[y][x] = 'ğŸ‘¤';
	                } else if(this.gameMap[y][x-1] == 'ğŸšª')
	                {
	                	this.level++;
	                	this.generateLevel();
	                } else if(this.gameMap[y][x-1] == 'ğŸ‘»')
	                {
	                	this.gameOver(); dead = true;
	                } else if(this.gameMap[y][x-1] == 'ğŸ”¥')
	                {
	                	this.gameOver(); dead = true;
	                } else if(this.gameMap[y][x-1] == 'ğŸ“¦')
	                {
	                	if(this.gameMap[y][x-2] == 'âš«')
	                	{
	                		this.gameMap[y][x] = 'âš«';
	                		this.gameMap[y][x-1] = 'ğŸ‘¤';
	                		this.gameMap[y][x-2] = 'ğŸ“¦';
	                	} else
	                	{
	                		this.gameMap[y][x] = 'ğŸ‘¤';
	                	}
	                } else if(this.gameMap[y][x-1] == 'ğŸ”’')
	                {
	                	this.gameMap[y][x] = 'ğŸ‘¤';
	                } else if(this.gameMap[y][x-1] == 'ğŸ”‘')
	                {
	                	this.gameMap[y][x] = 'âš«';
	                	this.gameMap[y][x-1] = 'ğŸ‘¤';
	                	this.key = true;
	                }
	            } else if (reaction.emoji.name === 'â¡ï¸') //RIGHT
	            {
	                if(this.gameMap[y][x+1] == 'âš«')
	                {
	                	this.gameMap[y][x] = 'âš«';
	                	this.gameMap[y][x+1] = 'ğŸ‘¤';
	                } else if(this.gameMap[y][x+1] == 'ğŸŸ«')
	                {
	                	this.gameMap[y][x] = 'ğŸ‘¤';
	                } else if(this.gameMap[y][x+1] == 'ğŸšª')
	                {
	                	this.level++;
	                	this.generateLevel();
	                } else if(this.gameMap[y][x+1] == 'ğŸ‘»')
	                {
	                	this.gameOver(); dead = true;
	                } else if(this.gameMap[y][x+1] == 'ğŸ”¥')
	                {
	                	this.gameOver(); dead = true;
	                } else if(this.gameMap[y][x+1] == 'ğŸ“¦')
	                {
	                	if(this.gameMap[y][x+2] == 'âš«')
	                	{
	                		this.gameMap[y][x] = 'âš«';
	                		this.gameMap[y][x+1] = 'ğŸ‘¤';
	                		this.gameMap[y][x+2] = 'ğŸ“¦';
	                	} else
	                	{
	                		this.gameMap[y][x] = 'ğŸ‘¤';
	                	}
	                } else if(this.gameMap[y][x+1] == 'ğŸ”’')
	                {
	                	this.gameMap[y][x] = 'ğŸ‘¤';
	                } else if(this.gameMap[y][x+1] == 'ğŸ”‘')
	                {
	                	this.gameMap[y][x] = 'âš«';
	                	this.gameMap[y][x+1] = 'ğŸ‘¤';
	                	this.key = true;
	                }
	            } else if (reaction.emoji.name === 'â¬†') //UP
	            {
	            	if(this.gameMap[y-1][x] == 'âš«')
	                {
	                	this.gameMap[y][x] = 'âš«';
	                	this.gameMap[y-1][x] = 'ğŸ‘¤';
	                } else if(this.gameMap[y-1][x] == 'ğŸŸ«')
	                {
	                	this.gameMap[y][x] = 'ğŸ‘¤';
	                } else if(this.gameMap[y-1][x] == 'ğŸšª')
	                {
	                	this.level++;
	                	this.generateLevel();
	                } else if(this.gameMap[y-1][x] == 'ğŸ‘»')
	                {
	                	this.gameOver(); dead = true;
	                } else if(this.gameMap[y-1][x] == 'ğŸ”¥')
	                {
	                	this.gameOver(); dead = true;
	                } else if(this.gameMap[y-1][x] == 'ğŸ“¦')
	                {
	                	if(this.gameMap[y-2][x] == 'âš«')
	                	{
	                		this.gameMap[y][x] = 'âš«';
	                		this.gameMap[y-1][x] = 'ğŸ‘¤';
	                		this.gameMap[y-2][x] = 'ğŸ“¦';
	                	} else
	                	{
	                		this.gameMap[y][x] = 'ğŸ‘¤';
	                	}
	                } else if(this.gameMap[y-1][x] == 'ğŸ”’')
	                {
	                	this.gameMap[y][x] = 'ğŸ‘¤';
	                } else if(this.gameMap[y-1][x] == 'ğŸ”‘')
	                {
	                	this.gameMap[y][x] = 'âš«';
	                	this.gameMap[y-1][x] = 'ğŸ‘¤';
	                	this.key = true;
	                }
	            } else if (reaction.emoji.name === 'â¬‡') //DOWN
	            {
	            	if(this.gameMap[y+1][x] == 'âš«')
	                {
	                	this.gameMap[y][x] = 'âš«';
	                	this.gameMap[y+1][x] = 'ğŸ‘¤';
	                } else if(this.gameMap[y+1][x] == 'ğŸŸ«')
	                {
	                	this.gameMap[y][x] = 'ğŸ‘¤';
	                } else if(this.gameMap[y+1][x] == 'ğŸšª')
	                {
	                	this.level++;
	                	this.generateLevel();
	                } else if(this.gameMap[y+1][x] == 'ğŸ‘»')
	                {
	                	this.gameOver(); dead = true;
	                } else if(this.gameMap[y+1][x] == 'ğŸ”¥')
	                {
	                	this.gameOver(); dead = true;
	                } else if(this.gameMap[y+1][x] == 'ğŸ“¦')
	                {
	                	if(this.gameMap[y+2][x] == 'âš«')
	                	{
	                		this.gameMap[y][x] = 'âš«';
	                		this.gameMap[y+1][x] = 'ğŸ‘¤';
	                		this.gameMap[y+2][x] = 'ğŸ“¦';
	                	} else
	                	{
	                		this.gameMap[y][x] = 'ğŸ‘¤';
	                	}
	                } else if(this.gameMap[y+1][x] == 'ğŸ”’')
	                {
	                	this.gameMap[y][x] = 'ğŸ‘¤';
	                } else if(this.gameMap[y+1][x] == 'ğŸ”‘')
	                {
	                	this.gameMap[y][x] = 'âš«';
	                	this.gameMap[y+1][x] = 'ğŸ‘¤';
	                	this.key = true;
	                }
	            } else if (reaction.emoji.name === 'ğŸ”„') //restart level
	            {
	            	this.generateLevel();
	            }

	            reaction.users.remove(reaction.users.cache.filter(user => user.id !== this.gameEmbed.author.id).first().id).then(() =>
	            {
	            	if(dead == false)
	            	{
	            		this.step();
	            	}
	            });
	        })
	        .catch(collected => 
	        {
	        	console.log("timeout");
	            this.gameOver();
	        });
	}
}

module.exports = EscapeGame;
